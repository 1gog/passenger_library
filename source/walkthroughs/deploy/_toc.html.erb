<% step = 0 %>
<a href="<%= url_for "/index.html" %>#walkthroughs" class="back-to-previous">&laquo; Back to all walkthroughs</a>

<h2>Deploy to production<br>
<small>for <%= language_name %> developers</small></h2>

<ul class="nav nav-stacked">
  <% navbar_subsection :intro do %>
    <% step += 1 %>
    <a href="<%= url_for "/walkthroughs/deploy/#{language_type}/index.html" %>">
      <% if available_infrastructures(locals).size > 1 %>
        <%= step %> Select infrastructure
        <% if locals[:infrastructure_type] %>
          <br><small>Chosen: <%= infrastructure_name %></small>
        <% end %>
      <% else %>
        <%= step %> Introduction
      <% end %>
    </a>
  <% end %>

  <% if needs_pick_integration_mode?(locals) != false %>
    <% if needs_pick_integration_mode?(locals).nil? || locals[:infrastructure_type].nil? %>
      <% step += 1 %>
      <li><span><%= step %> Pick integration mode</span></li>
    <% else %>
      <% navbar_subsection :integration_mode do %>
        <% step += 1 %>
        <a href="<%= url_for "/walkthroughs/deploy/#{language_type}/#{infrastructure_type}/integration_mode.html" %>">
          <%= step %> Pick integration mode
          <% if locals[:integration_mode_type] %>
            <br><small>Chosen: <%= integration_mode_name %></small>
          <% end %>
        </a>
      <% end %>
    <% end %>
  <% end %>

  <% if !locals[:infrastructure_type] || !locals[:integration_mode_type] %>
    <% step += 1 %>
    <li><span><%= step %> Open source vs Enterprise</span></li>
  <% else %>
    <% navbar_subsection :open_source_vs_enterprise do %>
      <% step += 1 %>
      <a href="<%= url_for "/walkthroughs/deploy/#{language_type}/#{infrastructure_type}/#{integration_mode_type}/open_source_vs_enterprise.html" %>">
        <%= step %> Open source vs Enterprise
        <% if locals[:edition_type] %>
          <br><small>Chosen: <%= edition_name %></small>
        <% end %>
      </a>
    <% end %>
  <% end %>

  <% if needs_launch_server?(locals) != false %>
    <% if locals[:infrastructure_type].nil? || locals[:integration_mode_type].nil? || locals[:edition_type].nil? || needs_launch_server?(locals).nil? %>
      <% step += 1 %>
      <li><span><%= step %> Launch a server</span></li>
    <% else %>
      <% navbar_subsection :launch_server do %>
        <% step += 1 %>
        <a href="<%= url_for "/walkthroughs/deploy/#{language_type}/#{infrastructure_type}/#{integration_mode_type}/#{edition_type}/launch_server.html" %>">
          <%= step %> Launch a server
        </a>
      <% end %>
    <% end %>
  <% end %>

  <% if needs_install_language_runtime?(locals) != false %>
    <% if locals[:infrastructure_type].nil? || locals[:integration_mode_type].nil? || locals[:edition_type].nil? || needs_install_language_runtime?(locals).nil? %>
      <% step += 1 %>
      <li><span><%= step %> Install <%= language_name %></span></li>
    <% else %>
      <% navbar_subsection :install_language_runtime do %>
        <% step += 1 %>
        <a href="<%= url_for "/walkthroughs/deploy/#{language_type}/#{infrastructure_type}/#{integration_mode_type}/#{edition_type}/needs_install_language_runtime.html" %>">
          <%= step %> Install <%= language_name %>
        </a>
      <% end %>
    <% end %>
  <% end %>

  <% if needs_install_passenger?(locals) != false %>
    <% if locals[:infrastructure_type].nil? || locals[:integration_mode_type].nil? || locals[:edition_type].nil? || needs_install_passenger?(locals).nil? %>
      <% step += 1 %>
      <li><span><%= step %> Install Passenger</span></li>
    <% else %>
      <% navbar_subsection :install_passenger do %>
        <% step += 1 %>
        <a href="<%= url_for "/walkthroughs/deploy/#{language_type}/#{infrastructure_type}/#{integration_mode_type}/#{edition_type}/install_passenger.html" %>">
          <%= step %> Install Passenger
        </a>
      <% end %>
    <% end %>
  <% end %>

  <% if locals[:infrastructure_type].nil? || locals[:integration_mode_type].nil? || locals[:edition_type].nil? %>
    <% step += 1 %>
    <li><span><%= step %> Deploy app</span></li>
  <% else %>
    <% navbar_subsection :deploy_app do %>
      <% step += 1 %>
      <a href="<%= url_for "/walkthroughs/deploy/#{language_type}/#{infrastructure_type}/#{integration_mode_type}/#{edition_type}/deploy_app.html" %>">
        <%= step %> Deploy app
      </a>
    <% end %>
  <% end %>

  <% if locals[:infrastructure_type].nil? || locals[:integration_mode_type].nil? || locals[:edition_type].nil? %>
    <% step += 1 %>
    <li><span><%= step %> Conclusion</span></li>
  <% else %>
    <% navbar_subsection :conclusion do %>
      <% step += 1 %>
      <a href="<%= url_for "/walkthroughs/deploy/#{language_type}/#{infrastructure_type}/#{integration_mode_type}/#{edition_type}/conclusion.html" %>">
        <%= step %> Conclusion
      </a>
    <% end %>
  <% end %>
</ul>
